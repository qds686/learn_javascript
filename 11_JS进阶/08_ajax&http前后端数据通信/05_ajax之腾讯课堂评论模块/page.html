<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>腾讯课堂分页器</title>
  <style type="text/css">
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    a,
    span {
      margin-right: 10px;
    }
  </style>
</head>

<body>
  <div id="pagination"></div>
  <script>
    // JavaScript code for pagination functionality
    var oPagination = document.getElementById('pagination'),
      pageNum = 20,
      curPage = 1;

    // 初始化
    setPageBtns(pageNum, curPage);
    // 事件代理点击按钮
    oPagination.onclick = function (e) {
      var e = e || window.event,
        tar = e.target || e.srcElement,
        className = tar.className;

      switch (className) {
        case 'page-btn':
          curPage = +tar.getAttribute('data-page');
          setPageBtns(pageNum, curPage);
          break;
        case 'prev-btn':
          curPage -= 1;
          setPageBtns(pageNum, curPage);
          break;
        case 'next-btn':
          curPage += 1;
          setPageBtns(pageNum, curPage);
          break;
      }
    }

    function setPageBtns(pageNum, curPage) {
      /**
       * target：分页按钮的模板
       * @param (string) type: 当前项不能点击，其他项可点击，省略号不能点击
       * @param (number) num: 点击的当前页码「点击完当前页可以再点击当前页和其他页两种情况」
       * @param (number) curPage: 当前是第几页
      */
      var pageBtnTpl = function (type, num, curPage) {
        switch (type) {
          case 'btn':
            // 点击的是当前项
            if (curPage == num) {
              return `<span class="cur-page">${num}</span>`;
            } else {
              // 点击的不是当前按钮
              return `<a href="javascript:;" class="page-btn" data-page="${num}">${num}</a>`;
            }
            break;
          case 'prev':
            // 在第一项
            if (curPage == 1) {
              return `<span class="disabled">&lt;</span>`;
            } else {
              return `<a href="javascript:;" class="prev-btn">&lt;</a>`;
            }
            break;
          case 'next':
            // 在最后一项
            if (curPage == pageNum) {
              return `<span class="disabled">&gt;</span>`;
            } else {
              return `<a href="javascript:;" class="next-btn">&gt;</a>`;
            }
            break;
          case 'points':
            return `<span>...</span>`;
            break;
        }
      }

      var btnGroup = '';

      function makeBtnGroup(start, end, curPage) {
        for (var i = start; i <= end; i++) {
          btnGroup += pageBtnTpl('btn', i, curPage);
        }
      }

      btnGroup += pageBtnTpl('prev', pageNum, curPage);

      if (pageNum > 7) {
        // 1 [2] 3 ... 19 20
        if (curPage < 3) {
          makeBtnGroup(1, 3, curPage);
          btnGroup += pageBtnTpl('points');
          makeBtnGroup(pageNum - 1, pageNum, curPage);
        } else if (curPage >= 3 && curPage < 5) {
          // 1 2 [3] 4 ... 19 20
          // 1 2 3 [4] 5 ... 19 20
          // 点击3显示4，点击4显示5，而不是点击3直接出现4 5
          makeBtnGroup(1, curPage + 1, curPage);
          btnGroup += pageBtnTpl('points');
          makeBtnGroup(pageNum - 1, pageNum, curPage);
        } else if (curPage >= 5 && curPage < pageNum - 3) {
          // 1 2 ... 4 [5] 6 ... 19 20
          // 1 2 ... 15 [16] 17 ... 19 20
          // 点击5的时候会变成这种情况
          makeBtnGroup(1, 2, curPage);
          btnGroup += pageBtnTpl('points');
          makeBtnGroup(curPage - 1, curPage + 1, curPage);
          btnGroup += pageBtnTpl('points');
          makeBtnGroup(pageNum - 1, pageNum, curPage);
        } else if (curPage >= pageNum - 3 && curPage <= pageNum - 1) {
          // 1 2 ... 16 [17] 18 19 20
          // 1 2 ... 18 [19] 20
          makeBtnGroup(1, 2, curPage);
          btnGroup += pageBtnTpl('points');
          // 这里最后点击是逐渐减少的过程，不是固定的5个Btn
          // 所以不应该是pageNum - 4，而是curPage - 1
          makeBtnGroup(curPage - 1, pageNum, curPage);
        } else if (curPage === pageNum) {
          // 在最后一页的时候 显示3项 不再减少
          // 1 2 ... 18 19 [20]
          makeBtnGroup(1, 2, curPage);
          btnGroup += pageBtnTpl('points');
          makeBtnGroup(pageNum - 2, pageNum, curPage);
        }
      } else {
        makeBtnGroup(1, pageNum, curPage);
      }

      btnGroup += pageBtnTpl('next', pageNum, curPage);

      oPagination.innerHTML = btnGroup;
    }
  </script>
</body>

</html>